# ä»»åŠ¡æ‚¬èµç³»ç»Ÿ

ä¸€ä¸ªåŸºäº Node.js + Express + SQLite çš„ä»»åŠ¡æ‚¬èµå¹³å°ï¼Œç”¨æˆ·å¯ä»¥å‘å¸ƒä»»åŠ¡å¹¶è®¾ç½®æ‚¬èµï¼Œå…¶ä»–ç”¨æˆ·å¯ä»¥æ¥å•å®Œæˆä»»åŠ¡ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- **ä»»åŠ¡ç®¡ç†**ï¼šåˆ›å»ºã€æŸ¥çœ‹ã€æ¥å•ã€å®Œæˆä»»åŠ¡
- **ç”¨æˆ·ç³»ç»Ÿ**ï¼šç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ç­‰çº§ç®¡ç†
- **æ‚¬èµæœºåˆ¶**ï¼šä»»åŠ¡å‘å¸ƒè€…è®¾ç½®æ‚¬èµé‡‘é¢
- **ç­‰çº§é™åˆ¶**ï¼šä»»åŠ¡å¯è®¾ç½®æœ€ä½ç­‰çº§è¦æ±‚
- **å¹¶å‘æ§åˆ¶**ï¼šé˜²æ­¢å¤šäººåŒæ—¶æŠ¢å•çš„ç«æ€æ¡ä»¶

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**ï¼šNode.js + Express.js
- **æ•°æ®åº“**ï¼šSQLite3
- **API**ï¼šRESTful API è®¾è®¡

## ğŸ“ é¡¹ç›®ç»“æ„

```
Task/
â”œâ”€â”€ backend/                 # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ routes/             
â”‚   â”‚   â””â”€â”€ tasks.js        # ä»»åŠ¡ç›¸å…³APIè·¯ç”±
â”‚   â”œâ”€â”€ db.js               # æ•°æ®åº“è¿æ¥é…ç½®
â”‚   â”œâ”€â”€ server.js           # æœåŠ¡å™¨å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ init_db.js          # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”‚   â””â”€â”€ insert_test_task2.js # æµ‹è¯•æ•°æ®æ’å…¥è„šæœ¬
â”œâ”€â”€ frontend/               # å‰ç«¯ä»£ç ï¼ˆå¾…å¼€å‘ï¼‰
â”œâ”€â”€ docs/                   # é¡¹ç›®æ–‡æ¡£
â”‚   â””â”€â”€ er.md              # æ•°æ®åº“ERå›¾
â”œâ”€â”€ db.sqlite              # SQLiteæ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ package.json           # é¡¹ç›®ä¾èµ–é…ç½®
â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### ç”¨æˆ·è¡¨ (user)
- `id`: ç”¨æˆ·å”¯ä¸€æ ‡è¯†
- `username`: ç”¨æˆ·å
- `password_hash`: å¯†ç å“ˆå¸Œ
- `level`: ç”¨æˆ·ç­‰çº§
- `created_at`: åˆ›å»ºæ—¶é—´

### ä»»åŠ¡è¡¨ (task)
- `id`: ä»»åŠ¡å”¯ä¸€æ ‡è¯†
- `title`: ä»»åŠ¡æ ‡é¢˜
- `description`: ä»»åŠ¡æè¿°
- `reward`: æ‚¬èµé‡‘é¢
- `min_level`: æœ€ä½ç­‰çº§è¦æ±‚
- `status`: ä»»åŠ¡çŠ¶æ€ï¼ˆOPEN/TAKEN/COMPLETEDï¼‰
- `publisher_id`: å‘å¸ƒè€…ID
- `taker_id`: æ¥å•è€…ID
- `created_at`: åˆ›å»ºæ—¶é—´

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 14.0
- npm >= 6.0

### å®‰è£…ä¾èµ–
```bash
npm install
```

### åˆå§‹åŒ–æ•°æ®åº“
```bash
node backend/init_db.js
```

### æ’å…¥æµ‹è¯•æ•°æ®ï¼ˆå¯é€‰ï¼‰
```bash
node backend/insert_test_task2.js
```

### å¯åŠ¨æœåŠ¡å™¨
```bash
node backend/server.js
```

æœåŠ¡å™¨å°†åœ¨ `http://localhost:3000` å¯åŠ¨

## ğŸ“š API æ–‡æ¡£

### åŸºç¡€URL
```
http://localhost:3000/api
```

### ä»»åŠ¡ç›¸å…³æ¥å£

#### 1. è·å–æ‰€æœ‰ä»»åŠ¡
```http
GET /api/tasks
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
[
  {
    "id": 1,
    "title": "ç¬¬äºŒä¸ªæµ‹è¯•ä»»åŠ¡",
    "description": "è¿™æ˜¯ç¬¬äºŒä¸ªæµ‹è¯•ä»»åŠ¡",
    "reward": 200,
    "min_level": 1,
    "status": "OPEN",
    "publisher_id": 1,
    "taker_id": null,
    "created_at": "2024-01-01 10:00:00"
  }
]
```

#### 2. è·å–å•ä¸ªä»»åŠ¡è¯¦æƒ…
```http
GET /api/tasks/:id
```

**å‚æ•°ï¼š**
- `id`: ä»»åŠ¡ID

#### 3. æ¥å•
```http
POST /api/tasks/:id/accept
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "taker_id": 2
}
```

**åŠŸèƒ½è¯´æ˜ï¼š**
- ä½¿ç”¨äº‹åŠ¡ç¡®ä¿å¹¶å‘å®‰å…¨
- åªæœ‰çŠ¶æ€ä¸º OPEN çš„ä»»åŠ¡æ‰èƒ½è¢«æ¥å•
- é˜²æ­¢é‡å¤æ¥å•

#### 4. å®Œæˆä»»åŠ¡
```http
POST /api/tasks/:id/finish
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "taker_id": 2
}
```

**åŠŸèƒ½è¯´æ˜ï¼š**
- åªæœ‰æ¥å•è€…å¯ä»¥æ ‡è®°ä»»åŠ¡å®Œæˆ
- ä»»åŠ¡çŠ¶æ€å¿…é¡»ä¸º TAKEN

#### 5. å‘å¸ƒæ–°ä»»åŠ¡
```http
POST /api/tasks
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "title": "ä»»åŠ¡æ ‡é¢˜",
  "description": "ä»»åŠ¡è¯¦ç»†æè¿°",
  "reward": 500,
  "min_level": 1,
  "publisher_id": 1
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "message": "Task created successfully",
  "task": {
    "id": 3,
    "title": "ä»»åŠ¡æ ‡é¢˜",
    "description": "ä»»åŠ¡è¯¦ç»†æè¿°",
    "reward": 500,
    "min_level": 1,
    "status": "OPEN",
    "publisher_id": 1,
    "taker_id": null,
    "created_at": "2024-01-01 12:00:00"
  }
}
```

**åŠŸèƒ½è¯´æ˜ï¼š**
- å‘å¸ƒè€…å¯ä»¥åˆ›å»ºæ–°ä»»åŠ¡
- å¿…å¡«å­—æ®µï¼štitle, description, reward, publisher_id
- min_level é»˜è®¤ä¸º1
- æ–°ä»»åŠ¡çŠ¶æ€è‡ªåŠ¨è®¾ä¸º OPEN

#### 6. è·å–æˆ‘æ¥çš„ä»»åŠ¡
```http
GET /api/tasks/my/:takerId
```

**å‚æ•°ï¼š**
- `takerId`: æ¥å•è€…ç”¨æˆ·ID

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "message": "My tasks retrieved successfully",
  "count": 2,
  "tasks": [
    {
      "id": 1,
      "title": "æˆ‘æ¥çš„ä»»åŠ¡1",
      "description": "ä»»åŠ¡æè¿°",
      "reward": 200,
      "min_level": 1,
      "status": "TAKEN",
      "publisher_id": 1,
      "taker_id": 2,
      "created_at": "2024-01-01 10:00:00"
    }
  ]
}
```

**åŠŸèƒ½è¯´æ˜ï¼š**
- æŸ¥çœ‹æŒ‡å®šç”¨æˆ·æ¥çš„æ‰€æœ‰ä»»åŠ¡
- æŒ‰åˆ›å»ºæ—¶é—´å€’åºæ’åˆ—
- åŒ…å«ä»»åŠ¡æ•°é‡ç»Ÿè®¡

## ğŸ”§ å¼€å‘è®¡åˆ’

### å·²å®ŒæˆåŠŸèƒ½
- âœ… åŸºç¡€æ•°æ®åº“è®¾è®¡
- âœ… ä»»åŠ¡æŸ¥çœ‹æ¥å£ (GET /api/tasks, GET /api/tasks/:id)
- âœ… ä»»åŠ¡æ¥å•åŠŸèƒ½ (POST /api/tasks/:id/accept)
- âœ… ä»»åŠ¡å®ŒæˆåŠŸèƒ½ (POST /api/tasks/:id/finish)
- âœ… ä»»åŠ¡å‘å¸ƒæ¥å£ (POST /api/tasks)
- âœ… æˆ‘çš„ä»»åŠ¡æŸ¥è¯¢ (GET /api/tasks/my/:takerId)
- âœ… å¹¶å‘æ§åˆ¶ï¼ˆæ¥å•æ—¶é˜²æ­¢é‡å¤æŠ¢å•ï¼‰
- âœ… åŸºç¡€å‚æ•°æ ¡éªŒå’Œé”™è¯¯å¤„ç†

### å¾…å¼€å‘åŠŸèƒ½
- ğŸ”² ç”¨æˆ·æ³¨å†Œ/ç™»å½•ç³»ç»Ÿ
- ğŸ”² JWT è®¤è¯ä¸­é—´ä»¶
- ğŸ”² ç”¨æˆ·ç­‰çº§ç³»ç»Ÿ
- ğŸ”² å‰ç«¯ç•Œé¢ï¼ˆä»»åŠ¡åˆ—è¡¨ã€è¯¦æƒ…ã€æˆ‘çš„ä»»åŠ¡é¡µï¼‰
- ğŸ”² å•å…ƒæµ‹è¯•ï¼ˆAPIæ¥å£æµ‹è¯•ï¼‰
- ğŸ”² éƒ¨ç½²è„šæœ¬ï¼ˆNode.js + Nginxï¼‰
- ğŸ”² æ‚¬èµé‡‘ç®¡ç†
- ğŸ”² ä»»åŠ¡è¯„ä»·ç³»ç»Ÿ

## ğŸ¤ å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ 2 ç©ºæ ¼ç¼©è¿›
- å‡½æ•°å’Œå˜é‡å‘½åä½¿ç”¨é©¼å³°å‘½åæ³•
- æ•°æ®åº“å­—æ®µä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•
- æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“äº‹åŠ¡**ï¼šæ¥å•æ“ä½œä½¿ç”¨äº†æ•°æ®åº“äº‹åŠ¡æ¥é˜²æ­¢å¹¶å‘é—®é¢˜
2. **é”™è¯¯å¤„ç†**ï¼šæ‰€æœ‰APIéƒ½åŒ…å«äº†é€‚å½“çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç 
3. **æ•°æ®éªŒè¯**ï¼šéœ€è¦åœ¨åç»­å¼€å‘ä¸­æ·»åŠ æ›´ä¸¥æ ¼çš„æ•°æ®éªŒè¯
4. **å®‰å…¨æ€§**ï¼šå½“å‰ç‰ˆæœ¬ç¼ºå°‘èº«ä»½éªŒè¯ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦æ·»åŠ JWTç­‰è®¤è¯æœºåˆ¶